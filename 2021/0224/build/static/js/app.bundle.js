(()=>{var e="＊　うざいくま があらわれた。<br>＊　ただの クソザコ。",t=[{action:"ぶんせき",phrase:"＊　うざいくま - ATK 1 DEF 1<br>＊　そのへんに よくいる くま。"},{action:"くどく",phrase:"＊　うざいくまをくどいてみた。<br>＊　まんざらでもなさそうだ。"},{action:"ナデナデ",phrase:"＊　くまをナデナデしてみた。<br>＊　「コレガ…ヒトノ…ココロ…」"},{action:"ひっぱたく",phrase:"＊　くまをひっぱたいた。<br>＊　おこってるようだが<br>　　なにを言ってるかわからない。"}],n=null,s=[{normal:"./static/image/fight.png",selected:"./static/image/fight_selected.png"},{normal:"./static/image/act.png",selected:"./static/image/act_selected.png"},{normal:"./static/image/item.png",selected:"./static/image/item_selected.png"},{normal:"./static/image/mercy.png",selected:"./static/image/mercy_selected.png"}],a=null,l=null,d=null,c="command",o=[],m=null,r=null,u=null,g=null,p=null,f=null,y=0,h=0,v=0,L=function e(t){g.innerHTML=t.substring(0,y++),y<=t.length?l=setTimeout((function(){e(t)}),50):i=0},b=function(){I(),c="fight",r.classList.remove("is-hidden"),(u=document.getElementById("moving-line")).classList.add("is-moved")},C=function(e){e=parseInt(e);var t=document.getElementById("damege-text"),n=document.getElementById("enemy-life-gage"),i=document.getElementById("enemy-img");(m=document.getElementById("enemy-life")).classList.remove("is-hidden"),i.classList.add("is-dameged"),t.innerText=e;var s=2.5*e,a=getComputedStyle(n).width;a=Number(a.replace(/px/g,"")),n.style.width=a-s>=0?a-s+"px":"0px",setTimeout((function(){E(),I(),B(),t.innerText="",u.style.animation="",i.classList.remove("is-dameged")}),2e3)},E=function(){m.classList.add("is-hidden")},w=function(){c="act",I(),p.classList.remove("is-hidden");for(var e=0;e<t.length;e++){var n=document.createElement("span");n.classList.add("act-text-item"),n.innerText="＊　"+t[e].action,p.appendChild(n)}(f=document.querySelectorAll(".act-text-item"))[0].classList.add("is-selected")},k=function(e){p.innerHTML="",g.classList.remove("is-hidden"),L(t[e].phrase)},x=function(){},T=function(){},I=function(){clearTimeout(l),y=0,g.innerHTML="",g.classList.add("is-hidden"),p.classList.add("is-hidden"),r.classList.add("is-hidden")},A=null,B=function(){c="enemy-attack",a.classList.add("will-be-attacked"),(A=document.createElement("img")).setAttribute("src","./static/image/heart.png"),A.setAttribute("width","30px"),A.setAttribute("height","30px"),A.style.position="absolute",A.style.top="50%",A.style.left="calc(50% - 15px)",a.appendChild(A),M(),setTimeout((function(){A.remove(),H()}),5e3),setTimeout((function(){I(),g.classList.remove("is-hidden"),c="command",n.forEach((function(e){e.classList.remove("is-selected")})),n[0].classList.add("is-selected"),n[h].firstElementChild.src=s[h].selected,h=0,L(e)}),5500)},S=null,M=function(){(S=document.createElement("div")).classList.add("bullet-wrapper"),a.appendChild(S),N(),setTimeout((function(){a.removeChild(S)}),5e3)},N=function(){var e=document.createElement("img");e.setAttribute("src","./static/image/bullet.png"),e.classList.add("bullet");for(var t=0;t<20;t++)_(e)},_=function e(t){var n=t.cloneNode(!0),i=n.style;i.left=100*Math.random()-"7"+"%",i.animationDelay=2*Math.random()+"s",S.appendChild(n),n.addEventListener("animationend",(function(){S.removeChild(n);var t=document.createElement("img");t.setAttribute("src","./static/image/bullet.png"),t.classList.add("bullet"),e(t)}))},H=function(){a.style.animation=" windowScale 0.5s linear forwards, windowScale 0.5s linear reverse forwards",setTimeout((function(){a.classList.remove("will-be-attacked"),a.style.animation=""}),1e3)};window.addEventListener("load",(function(){a=document.getElementById("main-window"),g=document.getElementById("type-anim"),p=document.getElementById("act-text"),n=document.querySelectorAll(".button-list-item-button"),r=document.getElementById("fight-bg"),window.addEventListener("keydown",(function(e){var t;"command"===c?(39!==e.keyCode&&37!==e.keyCode||(t=e.keyCode,n[h].classList.remove("is-selected"),n[h].firstElementChild.src=s[h].normal,39===t?h<3?h+=1:3===h&&(h=0):37===t&&(h>0?h-=1:0===h&&(h=3)),n[h].classList.add("is-selected"),n[h].firstElementChild.src=s[h].selected),13===e.keyCode&&(0===h&&b(),1===h&&w(),2===h&&x(),3===h&&T())):"act"===c?(e.keyCode>36&&e.keyCode<41&&function(e){f[v].classList.remove("is-selected"),39===e||37===e?0===v?v=1:1===v?v=0:2===v?v=3:3===v&&(v=2):38!==e&&40!==e||(0===v?v=2:1===v?v=3:2===v?v=0:3===v&&(v=1)),f[v].classList.add("is-selected")}(e.keyCode),13===e.keyCode&&(I(),k(v),v=0,c="act-phrase")):"act-phrase"===c?13===e.keyCode&&(I(),B()):"enemy-attack"===c?e.keyCode>36&&e.keyCode<41&&function(e){var t=getComputedStyle(A).left,n=getComputedStyle(A).top;t=Number(t.replace(/px/g,"")),n=Number(n.replace(/px/g,"")),o.push(d=setInterval((function(){37===e&&t>-10&&(t-=5),38===e&&n>-10&&(n-=5),39===e&&t<270&&(t+=5),40===e&&n<185&&(n+=5),A.style.left=t+"px",A.style.top=n+"px"}),20)),o.push(d)}(e.keyCode):"fight"===c&&13===e.keyCode&&function(){var e=document.body.clientWidth,t=u.getBoundingClientRect().left;u.style.animation="movingLineAnim 1.5s linear forwards paused, movingLineColorAnim 0.2s linear infinite";var n=t/e*100;n>50&&(n=50-(n-50)),C(n)}()})),window.addEventListener("keyup",(function(e){if("enemy-attack"===c&&o.length>0){for(var t=0;t<o.length;t++)clearInterval(o[t]);o.splice(0)}})),L(e)}))})();
(()=>{function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,a=!1,s=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){a=!0,s=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw s}}return n}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var n="＊　うざいくま があらわれた。<br>＊　ただの クソザコ。",i=[{action:"ぶんせき",phrase:"＊　うざいくま - ATK 1 DEF 1<br>＊　そのへんに よくいる くま。"},{action:"くどく",phrase:"＊　うざいくまをくどいてみた。<br>＊　まんざらでもなさそうだ。"},{action:"ナデナデ",phrase:"＊　くまをナデナデしてみた。<br>＊　「コレガ…ヒトノ…ココロ…」"},{action:"ひっぱたく",phrase:"＊　くまをひっぱたいた。<br>＊　おこってるようだが<br>　　なにを言ってるかわからない。"}],a="＊　どうやら開発者は<br>　　これを実装する余裕が<br>　　なかったようだ…",s="あきらめては　いけない…<br>リロードして<br>ケツイをちからに　かえるんだ…",r=null,o=[{normal:"./static/image/fight.png",selected:"./static/image/fight_selected.png"},{normal:"./static/image/act.png",selected:"./static/image/act_selected.png"},{normal:"./static/image/item.png",selected:"./static/image/item_selected.png"},{normal:"./static/image/mercy.png",selected:"./static/image/mercy_selected.png"}],l=null,c=null,d=null,m=null,u=null,y="command",f=[],g=null,p=null,h=null,v=null,b=null,L=!1,w=null,C=null,E=null,x=0,k=0,T=0,I=function e(t){w.innerHTML=t.substring(0,x++),x<=t.length?c=setTimeout((function(){e(t)}),50):x=0},B=function(){_(),y="fight",h.classList.remove("is-hidden"),(v=document.getElementById("moving-line")).classList.add("is-moved"),d=setTimeout((function(){_(),R()}),1500)},A=function(e){e=parseInt(e);var t,n=document.getElementById("damege-text"),i=document.getElementById("enemy-life-gage");g=document.getElementById("enemy-img"),(p=document.getElementById("enemy-life")).classList.remove("is-hidden"),g.classList.add("is-dameged"),n.innerText=e;var a=2.5*e,s=getComputedStyle(i).width;s=Number(s.replace(/px/g,"")),t=setTimeout((function(){N(),_(),R(),n.innerText="",v.style.animation="",g.classList.remove("is-dameged")}),2e3),s-a>=0?i.style.width=s-a+"px":(i.style.width="0px",clearTimeout(t),setTimeout((function(){N(),Q(),_(),w.classList.remove("is-hidden"),I("＊　YOU WIN！<br>＊　0EXPと2ゴールドを　かくとく！<br>＊　（おわり）"),y="ending"}),1e3))},N=function(){p.classList.add("is-hidden")},S=function(){y="act",_(),C.classList.remove("is-hidden");for(var e=0;e<i.length;e++){var t=document.createElement("span");t.classList.add("act-text-item"),t.innerText="＊　"+i[e].action,C.appendChild(t)}(E=document.querySelectorAll(".act-text-item"))[0].classList.add("is-selected")},M=function(e){C.innerHTML="",w.classList.remove("is-hidden"),I(i[e].phrase)},j=function(){y="item",_(),w.classList.remove("is-hidden"),I(a)},H=function(){y="mercy",_(),w.classList.remove("is-hidden"),I(a)},O=function(){_(),w.classList.remove("is-hidden"),y="command",r.forEach((function(e){e.classList.remove("is-selected")})),r[0].classList.add("is-selected"),r[k].firstElementChild.src=o[k].normal,r[0].firstElementChild.src=o[0].selected,k=0,I(n)},_=function(){clearTimeout(c),x=0,w.innerHTML="",w.classList.add("is-hidden"),C.classList.add("is-hidden"),h.classList.add("is-hidden")},R=function(){y="enemy-attack",l.classList.add("will-be-attacked"),b=document.createElement("img"),q(b);var e=document.createElement("img"),t=U();D(e),setTimeout((function(){b.remove(),e.remove(),clearInterval(t),J()}),5e3),m=setTimeout((function(){O()}),5500)},q=function(){b.setAttribute("src","./static/image/heart.png"),b.setAttribute("width","30px"),b.setAttribute("height","30px"),b.setAttribute("id","enemy-attack-player"),b.style.position="absolute",b.style.top="50%",b.style.left="calc(50% - 15px)",l.appendChild(b)},D=function(e){e.setAttribute("src","./static/image/kuma.gif"),e.classList.add("enemy-attack-gif"),l.appendChild(e)},U=function(){return setInterval((function(){W()}),100)},W=function(){if(!L){var t=e(z(),2),n=t[0],i=t[1],a=e(G(),2),s=a[0],r=a[1];(F(n,s)<15||F(i,r)<15)&&(L=!0,K(),P(),$())}},F=function(e,t){return Math.abs(e-t)},K=function(){var e=document.getElementById("enemy-attack-player");e.style.animation="playerDamageAnim 1s linear",setTimeout((function(){e.style.animation="none",L=!1}),1e3)},P=function(){var e=document.getElementById("player-hp-box"),t=getComputedStyle(e).width,n=Number(t.replace(/px/g,""));n-4>=0?e.style.width=n-4+"px":(e.style.width="0px",X(),clearTimeout(m),setTimeout((function(){Y()}),2300))},X=function(){var e=document.getElementById("gameover-window"),t=document.getElementById("gameover-window-text");e.classList.remove("is-hidden"),t.classList.remove("is-hidden")},Y=function e(){document.getElementById("gameover-type-anim").innerHTML=s.substring(0,x++),x<=s.length?c=setTimeout((function(){e()}),50):(clearTimeout(c),x=0)},$=function(){var e=document.getElementById("player-status-hp-num"),t=Number(e.textContent);t-1.25>=0?(t-=1.25,e.innerText=Math.round(t)):e.innerText=0},z=function(){var e=document.getElementsByClassName("enemy-attack-gif")[0].getBoundingClientRect();return[Number(e.left)+Number(e.right)/2,Number(e.top)+Number(e.bottom)/2]},G=function(){var e=document.getElementById("enemy-attack-player").getBoundingClientRect();return[Number(e.left)+Number(e.right)/2,Number(e.top)+Number(e.bottom)/2]},J=function(){l.style.animation=" windowScale 0.5s linear forwards, windowScale 0.5s linear reverse forwards",setTimeout((function(){l.classList.remove("will-be-attacked"),l.style.animation=""}),1e3)},Q=function(){g.classList.add("is-hidden")};window.addEventListener("load",(function(){l=document.getElementById("main-window"),w=document.getElementById("type-anim"),C=document.getElementById("act-text"),itemText=document.getElementById("item-text"),r=document.querySelectorAll(".button-list-item-button"),h=document.getElementById("fight-bg"),window.addEventListener("keydown",(function(e){var t;"command"===y?(39!==e.keyCode&&37!==e.keyCode||(t=e.keyCode,r[k].classList.remove("is-selected"),r[k].firstElementChild.src=o[k].normal,39===t?k<3?k+=1:3===k&&(k=0):37===t&&(k>0?k-=1:0===k&&(k=3)),r[k].classList.add("is-selected"),r[k].firstElementChild.src=o[k].selected),13===e.keyCode&&(0===k&&B(),1===k&&S(),2===k&&j(),3===k&&H())):"act"===y?(e.keyCode>36&&e.keyCode<41&&function(e){E[T].classList.remove("is-selected"),39===e||37===e?0===T?T=1:1===T?T=0:2===T?T=3:3===T&&(T=2):38!==e&&40!==e||(0===T?T=2:1===T?T=3:2===T?T=0:3===T&&(T=1)),E[T].classList.add("is-selected")}(e.keyCode),13===e.keyCode&&(_(),M(T),T=0,y="act-phrase")):"act-phrase"===y?13===e.keyCode&&(_(),R()):"enemy-attack"===y?e.keyCode>36&&e.keyCode<41&&function(e){var t=getComputedStyle(b).left,n=getComputedStyle(b).top;t=Number(t.replace(/px/g,"")),n=Number(n.replace(/px/g,"")),f.push(u=setInterval((function(){37===e&&t>-10&&(t-=5),38===e&&n>-10&&(n-=5),39===e&&t<270&&(t+=5),40===e&&n<185&&(n+=5),b.style.left=t+"px",b.style.top=n+"px"}),20)),f.push(u)}(e.keyCode):"fight"===y?13===e.keyCode&&function(){clearTimeout(d);var e=document.body.clientWidth,t=v.getBoundingClientRect().left;v.style.animation="movingLineAnim 1.5s linear forwards paused, movingLineColorAnim 0.2s linear infinite";var n=t/e*100;n>50&&(n=50-(n-50)),A(n)}():"item"!==y&&"mercy"!==y||13===e.keyCode&&O()})),window.addEventListener("keyup",(function(e){if("enemy-attack"===y&&f.length>0){for(var t=0;t<f.length;t++)clearInterval(f[t]);f.splice(0)}})),I(n)}))})();
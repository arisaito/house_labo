(()=>{var e="＊　うざいくま があらわれた。<br>＊　ただの クソザコ。",t=[{action:"ぶんせき",phrase:"＊　うざいくま - ATK 1 DEF 1<br>＊　そのへんに よくいる くま。"},{action:"くどく",phrase:"＊　うざいくまをくどいてみた。<br>＊　まんざらでもなさそうだ。"},{action:"ナデナデ",phrase:"＊　くまをナデナデしてみた。<br>＊　「コレガ…ヒトノ…ココロ…」"},{action:"ひっぱたく",phrase:"＊　くまをひっぱたいた。<br>＊　おこってるようだが<br>　　なにを言ってるかわからない。"}],n=null,s=[{normal:"./static/image/fight.png",selected:"./static/image/fight_selected.png"},{normal:"./static/image/act.png",selected:"./static/image/act_selected.png"},{normal:"./static/image/item.png",selected:"./static/image/item_selected.png"},{normal:"./static/image/mercy.png",selected:"./static/image/mercy_selected.png"}],a=null,l=null,d=null,c="command",o=[],m=null,r=null,u=null,g=null,p=null,f=null,h=null,y=0,v=0,L=0,b=function e(t){p.innerHTML=t.substring(0,y++),y<=t.length?l=setTimeout((function(){e(t)}),50):i=0},C=function(){A(),c="fight",u.classList.remove("is-hidden"),(g=document.getElementById("moving-line")).classList.add("is-moved")},E=function(e){e=parseInt(e);var t,n=document.getElementById("damege-text"),i=document.getElementById("enemy-life-gage");m=document.getElementById("enemy-img"),(r=document.getElementById("enemy-life")).classList.remove("is-hidden"),m.classList.add("is-dameged"),n.innerText=e;var s=2.5*e,a=getComputedStyle(i).width;a=Number(a.replace(/px/g,"")),t=setTimeout((function(){w(),A(),S(),n.innerText="",g.style.animation="",m.classList.remove("is-dameged")}),2e3),a-s>=0?i.style.width=a-s+"px":(i.style.width="0px",clearTimeout(t),setTimeout((function(){w(),W(),A(),p.classList.remove("is-hidden"),b("＊　YOU WIN！<br>＊　0EXPと2ゴールドを　かくとく！<br>＊　（おわり）"),c="ending"}),1e3))},w=function(){r.classList.add("is-hidden")},k=function(){c="act",A(),f.classList.remove("is-hidden");for(var e=0;e<t.length;e++){var n=document.createElement("span");n.classList.add("act-text-item"),n.innerText="＊　"+t[e].action,f.appendChild(n)}(h=document.querySelectorAll(".act-text-item"))[0].classList.add("is-selected")},x=function(e){f.innerHTML="",p.classList.remove("is-hidden"),b(t[e].phrase)},T=function(){},I=function(){},A=function(){clearTimeout(l),y=0,p.innerHTML="",p.classList.add("is-hidden"),f.classList.add("is-hidden"),u.classList.add("is-hidden")},B=null,S=function(){c="enemy-attack",a.classList.add("will-be-attacked"),(B=document.createElement("img")).setAttribute("src","./static/image/heart.png"),B.setAttribute("width","30px"),B.setAttribute("height","30px"),B.style.position="absolute",B.style.top="50%",B.style.left="calc(50% - 15px)",a.appendChild(B),N(),setTimeout((function(){B.remove(),D()}),5e3),setTimeout((function(){A(),p.classList.remove("is-hidden"),c="command",n.forEach((function(e){e.classList.remove("is-selected")})),n[0].classList.add("is-selected"),n[v].firstElementChild.src=s[v].normal,n[0].firstElementChild.src=s[0].selected,v=0,b(e)}),5500)},M=null,N=function(){(M=document.createElement("div")).classList.add("bullet-wrapper"),a.appendChild(M),H(),setTimeout((function(){a.removeChild(M)}),5e3)},_=[],H=function(){var e=document.createElement("img");e.setAttribute("src","./static/image/bullet.png"),e.classList.add("bullet"),_.push(e);for(var t=0;t<20;t++)q(e)},q=function e(t){var n=t.cloneNode(!0),i=n.style;i.left=100*Math.random()-"7"+"%",i.animationDelay=2*Math.random()+"s",M.appendChild(n),_.push(n),n.addEventListener("animationend",(function(){M.removeChild(n);var t=document.createElement("img");t.setAttribute("src","./static/image/bullet.png"),t.classList.add("bullet"),e(t)}))},D=function(){a.style.animation=" windowScale 0.5s linear forwards, windowScale 0.5s linear reverse forwards",setTimeout((function(){a.classList.remove("will-be-attacked"),a.style.animation=""}),1e3)},W=function(){m.classList.add("is-hidden")};window.addEventListener("load",(function(){a=document.getElementById("main-window"),p=document.getElementById("type-anim"),f=document.getElementById("act-text"),n=document.querySelectorAll(".button-list-item-button"),u=document.getElementById("fight-bg"),window.addEventListener("keydown",(function(e){var t;"command"===c?(39!==e.keyCode&&37!==e.keyCode||(t=e.keyCode,n[v].classList.remove("is-selected"),n[v].firstElementChild.src=s[v].normal,39===t?v<3?v+=1:3===v&&(v=0):37===t&&(v>0?v-=1:0===v&&(v=3)),n[v].classList.add("is-selected"),n[v].firstElementChild.src=s[v].selected),13===e.keyCode&&(0===v&&C(),1===v&&k(),2===v&&T(),3===v&&I())):"act"===c?(e.keyCode>36&&e.keyCode<41&&function(e){h[L].classList.remove("is-selected"),39===e||37===e?0===L?L=1:1===L?L=0:2===L?L=3:3===L&&(L=2):38!==e&&40!==e||(0===L?L=2:1===L?L=3:2===L?L=0:3===L&&(L=1)),h[L].classList.add("is-selected")}(e.keyCode),13===e.keyCode&&(A(),x(L),L=0,c="act-phrase")):"act-phrase"===c?13===e.keyCode&&(A(),S()):"enemy-attack"===c?e.keyCode>36&&e.keyCode<41&&function(e){var t=getComputedStyle(B).left,n=getComputedStyle(B).top;t=Number(t.replace(/px/g,"")),n=Number(n.replace(/px/g,"")),o.push(d=setInterval((function(){37===e&&t>-10&&(t-=5),38===e&&n>-10&&(n-=5),39===e&&t<270&&(t+=5),40===e&&n<185&&(n+=5),B.style.left=t+"px",B.style.top=n+"px"}),20)),o.push(d)}(e.keyCode):"fight"===c&&13===e.keyCode&&function(){var e=document.body.clientWidth,t=g.getBoundingClientRect().left;g.style.animation="movingLineAnim 1.5s linear forwards paused, movingLineColorAnim 0.2s linear infinite";var n=t/e*100;n>50&&(n=50-(n-50)),E(n)}()})),window.addEventListener("keyup",(function(e){if("enemy-attack"===c&&o.length>0){for(var t=0;t<o.length;t++)clearInterval(o[t]);o.splice(0)}})),b(e)}))})();